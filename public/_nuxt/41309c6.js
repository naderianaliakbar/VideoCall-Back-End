(window.webpackJsonp=window.webpackJsonp||[]).push([[6,3],{561:function(e,t,r){var content=r(570);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,r(24).default)("182daade",content,!0,{sourceMap:!1})},562:function(e,t,r){var content=r(563);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,r(24).default)("e23b7040",content,!0,{sourceMap:!1})},563:function(e,t,r){var o=r(23)(!1);o.push([e.i,'.theme--light.v-card{background-color:#fff;color:rgba(0,0,0,.87)}.theme--light.v-card>.v-card__subtitle,.theme--light.v-card>.v-card__text{color:rgba(0,0,0,.6)}.theme--dark.v-card{background-color:#1e1e1e;color:#fff}.theme--dark.v-card>.v-card__subtitle,.theme--dark.v-card>.v-card__text{color:hsla(0,0%,100%,.7)}.v-sheet.v-card{border-radius:4px}.v-sheet.v-card:not(.v-sheet--outlined){box-shadow:0 3px 1px -2px rgba(0,0,0,.2),0 2px 2px 0 rgba(0,0,0,.14),0 1px 5px 0 rgba(0,0,0,.12)}.v-sheet.v-card.v-sheet--shaped{border-radius:24px 4px}.v-card{border-width:thin;display:block;max-width:100%;outline:none;text-decoration:none;transition-property:box-shadow,opacity;word-wrap:break-word;position:relative;white-space:normal}.v-card>.v-card__progress+:not(.v-btn):not(.v-chip):not(.v-avatar),.v-card>:first-child:not(.v-btn):not(.v-chip):not(.v-avatar){border-top-left-radius:inherit;border-top-right-radius:inherit}.v-card>:last-child:not(.v-btn):not(.v-chip):not(.v-avatar){border-bottom-left-radius:inherit;border-bottom-right-radius:inherit}.v-card__progress{top:0;left:0;right:0;overflow:hidden}.v-card__subtitle+.v-card__text{padding-top:0}.v-card__subtitle,.v-card__text{font-size:.875rem;font-weight:400;line-height:1.375rem;letter-spacing:.0071428571em}.v-card__subtitle,.v-card__text,.v-card__title{padding:16px}.v-card__title{align-items:center;display:flex;flex-wrap:wrap;font-size:1.25rem;font-weight:500;letter-spacing:.0125em;line-height:2rem;word-break:break-all}.v-card__title+.v-card__subtitle,.v-card__title+.v-card__text{padding-top:0}.v-card__title+.v-card__subtitle{margin-top:-16px}.v-card__text{width:100%}.v-card__actions{align-items:center;display:flex;padding:8px}.v-card__actions>.v-btn.v-btn{padding:0 8px}.v-application--is-ltr .v-card__actions>.v-btn.v-btn+.v-btn{margin-left:8px}.v-application--is-ltr .v-card__actions>.v-btn.v-btn .v-icon--left{margin-left:4px}.v-application--is-ltr .v-card__actions>.v-btn.v-btn .v-icon--right{margin-right:4px}.v-application--is-rtl .v-card__actions>.v-btn.v-btn+.v-btn{margin-right:8px}.v-application--is-rtl .v-card__actions>.v-btn.v-btn .v-icon--left{margin-right:4px}.v-application--is-rtl .v-card__actions>.v-btn.v-btn .v-icon--right{margin-left:4px}.v-card--flat{box-shadow:0 0 0 0 rgba(0,0,0,.2),0 0 0 0 rgba(0,0,0,.14),0 0 0 0 rgba(0,0,0,.12)!important}.v-sheet.v-card--hover{cursor:pointer;transition:box-shadow .4s cubic-bezier(.25,.8,.25,1)}.v-sheet.v-card--hover:focus,.v-sheet.v-card--hover:hover{box-shadow:0 5px 5px -3px rgba(0,0,0,.2),0 8px 10px 1px rgba(0,0,0,.14),0 3px 14px 2px rgba(0,0,0,.12)}.v-card--link,.v-card--link .v-chip{cursor:pointer}.v-card--link:focus:before{opacity:.08}.v-card--link:before{background:currentColor;bottom:0;content:"";left:0;opacity:0;pointer-events:none;position:absolute;right:0;top:0;transition:opacity .2s}.v-card--disabled{pointer-events:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.v-card--disabled>:not(.v-card__progress){opacity:.6;transition:inherit}.v-card--loading{overflow:hidden}.v-card--raised{box-shadow:0 5px 5px -3px rgba(0,0,0,.2),0 8px 10px 1px rgba(0,0,0,.14),0 3px 14px 2px rgba(0,0,0,.12)}',""]),e.exports=o},564:function(e,t,r){"use strict";r(10),r(9),r(12),r(3),r(15),r(11),r(16);var o=r(2),n=(r(25),r(206),r(207),r(562),r(273)),c=r(278),l=r(78),d=r(7);function m(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,r)}return t}function h(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?m(Object(source),!0).forEach((function(t){Object(o.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):m(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}t.a=Object(d.a)(c.a,l.a,n.a).extend({name:"v-card",props:{flat:Boolean,hover:Boolean,img:String,link:Boolean,loaderHeight:{type:[Number,String],default:4},raised:Boolean},computed:{classes:function(){return h(h({"v-card":!0},l.a.options.computed.classes.call(this)),{},{"v-card--flat":this.flat,"v-card--hover":this.hover,"v-card--link":this.isClickable,"v-card--loading":this.loading,"v-card--disabled":this.disabled,"v-card--raised":this.raised},n.a.options.computed.classes.call(this))},styles:function(){var style=h({},n.a.options.computed.styles.call(this));return this.img&&(style.background='url("'.concat(this.img,'") center center / cover no-repeat')),style}},methods:{genProgress:function(){var e=c.a.options.methods.genProgress.call(this);return e?this.$createElement("div",{staticClass:"v-card__progress",key:"progress"},[e]):null}},render:function(e){var t=this.generateRouteLink(),r=t.tag,data=t.data;return data.style=this.styles,this.isClickable&&(data.attrs=data.attrs||{},data.attrs.tabindex=0),e(r,this.setBackgroundColor(this.color,data),[this.genProgress(),this.$slots.default])}})},569:function(e,t,r){"use strict";r(561)},570:function(e,t,r){var o=r(23)(!1);o.push([e.i,".hideStream[data-v-7d8c088e]{display:none!important}.pointerCursor[data-v-7d8c088e]{cursor:pointer!important}.cardObject[data-v-7d8c088e]{min-width:100%!important;min-height:100%!important;max-width:100%!important;max-height:100%!important;border:1px solid #fff}.videoObject[data-v-7d8c088e]{width:100%!important;height:100%!important}.menuToggle[data-v-7d8c088e]{margin-right:-5px!important}",""]),e.exports=o},571:function(e,t,r){var content=r(572);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,r(24).default)("dd2325f0",content,!0,{sourceMap:!1})},572:function(e,t,r){var o=r(23)(!1);o.push([e.i,".theme--light.v-system-bar{background-color:#e0e0e0;color:rgba(0,0,0,.6)}.theme--light.v-system-bar .v-icon{color:rgba(0,0,0,.6)}.theme--light.v-system-bar--lights-out{background-color:hsla(0,0%,100%,.7)!important}.theme--dark.v-system-bar{background-color:#000;color:hsla(0,0%,100%,.7)}.theme--dark.v-system-bar .v-icon{color:hsla(0,0%,100%,.7)}.theme--dark.v-system-bar--lights-out{background-color:rgba(0,0,0,.2)!important}.v-system-bar{align-items:center;display:flex;font-size:.875rem;font-weight:400;padding:0 8px}.v-system-bar .v-icon{font-size:1rem;margin-right:4px}.v-system-bar--absolute,.v-system-bar--fixed{left:0;top:0;width:100%;z-index:3}.v-system-bar--fixed{position:fixed}.v-system-bar--absolute{position:absolute}.v-system-bar--window .v-icon{font-size:1.25rem;margin-right:8px}",""]),e.exports=o},577:function(e,t,r){var content=r(585);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,r(24).default)("0eed1c2c",content,!0,{sourceMap:!1})},579:function(e,t,r){"use strict";r.r(t);var o={name:"StreamObject",data:function(){return{streamName:"",cameraOff:!1,audioOff:!1}},methods:{selectAsMainStream:function(){this.isMainStream||this.$emit("selectAsMainStream",this.srcObject)}},props:["srcObject","isMainStream","voiceCall"],mounted:function(){this.$refs.videoObject.srcObject=this.srcObject,this.srcObject.user._id===this.$auth.user.id||this.srcObject.user.id===this.$auth.user.id?(this.$refs.videoObject.muted=!0,this.streamName="Me"):this.streamName=this.srcObject.user.firstName}},n=(r(569),r(81)),c=r(74),l=r.n(c),d=r(564),m=(r(10),r(9),r(12),r(3),r(15),r(11),r(16),r(2)),h=(r(25),r(143),r(571),r(131)),v=r(27),f=r(22),S=r(7),k=r(0);function x(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,r)}return t}var T=Object(S.a)(Object(h.a)("bar",["height","window"]),v.a,f.a).extend({name:"v-system-bar",props:{height:[Number,String],lightsOut:Boolean,window:Boolean},computed:{classes:function(){return function(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?x(Object(source),!0).forEach((function(t){Object(m.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):x(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}({"v-system-bar--lights-out":this.lightsOut,"v-system-bar--absolute":this.absolute,"v-system-bar--fixed":!this.absolute&&(this.app||this.fixed),"v-system-bar--window":this.window},this.themeClasses)},computedHeight:function(){return this.height?isNaN(parseInt(this.height))?this.height:parseInt(this.height):this.window?32:24},styles:function(){return{height:Object(k.g)(this.computedHeight)}}},methods:{updateApplication:function(){return this.$el?this.$el.clientHeight:this.computedHeight}},render:function(e){var data={staticClass:"v-system-bar",class:this.classes,style:this.styles,on:this.$listeners};return e("div",this.setBackgroundColor(this.color,data),Object(k.p)(this))}}),component=Object(n.a)(o,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-card",{staticClass:"pa-0 cardObject pointerCursor",class:e.voiceCall?"hideStream":"",attrs:{dark:"",width:"100%",height:"100%",tile:""},on:{click:e.selectAsMainStream}},[r("video",{ref:"videoObject",staticClass:"videoObject",attrs:{autoplay:""}}),e._v(" "),r("v-system-bar",{staticClass:"ma-0",attrs:{height:"30","lights-out":"",absolute:"",dark:""}},[r("ContactAvatar",{attrs:{avatar:e.srcObject.user.avatar,name:e.srcObject.user.firstName,color:e.srcObject.user.color,size:"50"}}),e._v(" "),r("h5",{staticClass:"caption white--text mx-2"},[e._v(e._s(e.streamName))])],1)],1)}),[],!1,null,"7d8c088e",null);t.default=component.exports;l()(component,{ContactAvatar:r(354).default}),l()(component,{VCard:d.a,VSystemBar:T})},584:function(e,t,r){"use strict";r(577)},585:function(e,t,r){var o=r(23)(!1);o.push([e.i,".gridVideos[data-v-1374a326]{width:100%!important}.gridVideos .listOfStreams[data-v-1374a326]{min-height:calc(100vh - 150px);max-height:calc(100vh - 150px)}.gridVideos .listOfStreams .streamItem[data-v-1374a326]{display:block;height:160px}.gridVideos .mainStream[data-v-1374a326]{max-height:calc(100vh - 150px);min-height:calc(100vh - 150px)}.gridVideos .listOfStreams[data-v-1374a326]{width:100%}.toggles[data-v-1374a326]{position:absolute!important;margin-top:-70px;z-index:1}@media screen and (max-width:959px){.gridVideos .mainStream[data-v-1374a326]{min-height:74vh;max-height:74vh}.gridVideos .listOfStreams[data-v-1374a326]{min-height:185px;max-height:185px;overflow-x:scroll;padding:0!important;margin:0!important}.gridVideos .listOfStreams .streamItem[data-v-1374a326]{display:inline-block;text-decoration:none;height:140px;width:49%;max-width:49%}}",""]),e.exports=o},628:function(e,t,r){"use strict";r.r(t);r(3),r(20),r(111),r(29),r(11),r(35),r(46),r(33),r(9),r(56),r(59),r(36);function o(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return n(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return n(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,l=!0,d=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return l=e.done,e},e:function(e){d=!0,c=e},f:function(){try{l||null==r.return||r.return()}finally{if(d)throw c}}}}function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,r=new Array(t);i<t;i++)r[i]=e[i];return r}var c={name:"call",auth:!0,data:function(){return{status:-1,loading:!0,loadingText:"",roomInfo:{},socket:"",creator:!1,peerUser:"",myPeerId:"",connection:null,peerConnection:null,microphone:!1,microphoneLoader:!1,camera:!1,cameraLoader:!1,screenShare:!1,screenShareLoader:!1,deviceWidth:0,deviceHeight:0,mainStream:"local",streams:{localUserMediaStream:null,localScreenShareStream:null,remoteUserMediaStream:null},streamsTracks:{localTracks:{userMediaTracks:{microphone:null,camera:null},screenShareTracks:{screenShareVideo:null,screenShareAudio:null}}},renderLocalStream:!1,renderScreenShareStream:!1,renderRemoteStream:!1,renderMainStream:!1}},computed:{directionOfLanguage:function(){return this.$nuxt.$i18n.localeProperties.dir},roomId:function(){return this.$store.state.user.roomId},userId:function(){return this.$auth.user.id},isMobile:function(){return[/Android/i,/webOS/i,/iPhone/i,/iPad/i,/iPod/i,/BlackBerry/i,/Windows Phone/i].some((function(e){return navigator.userAgent.match(e)}))},selectedMicrophoneId:function(){return this.$store.state.call.selectedMicrophoneId},selectedCameraId:function(){return this.$store.state.call.selectedCameraId},noiseSuppression:function(){return this.$store.state.call.noiseSuppression},echoCancellation:function(){return this.$store.state.call.echoCancellation}},mounted:function(){var e=this;this.socket=this.$websocket.getSocket(),this.peerConnection=this.$peer.getPeer(),this.roomId?(this.loadingText=this.$t("LOADING"),this.$axios.get("calls/"+this.roomId).then((function(t){if(e.roomInfo=t.data,e.creator=e.roomInfo.caller===e.userId,e.peerUser=e.creator?e.roomInfo.receiver:e.roomInfo.caller,e.status=0,0!==e.roomInfo.status&&(1!==e.roomInfo.status||e.creator))return e.destroyStreams(),void e.$router.push({path:"/contacts"});e.creator?(e.socket.emit("prepareCall",e.peerUser,e.roomInfo._id),e.loadingText=e.$t("PREPARING_CALL")):e.socket.emit("acceptCall",e.peerUser,e.roomInfo._id,e.$peer.getPeerId())})).catch((function(t){var r=t.response;if(r.status){if(403===r.status)e.$notifier.showMessage({content:e.$t("PERMISSION_DENIED"),color:"error"}),e.destroyStreams(),e.$router.push({path:"/contacts"})}else e.$notifier.showMessage({content:e.$t("REQUEST_FAILED"),color:"error"})}))):(this.destroyStreams(),this.$router.push({path:"/contacts"})),this.socket.on("callAccepted",(function(t){e.loadingText=e.$t("CONNECTING"),e.getUserMediaAccess((function(){var r=e.peerConnection.call(t,e.streams.localUserMediaStream);e.connection=r.peerConnection,e.loading=!1,r.on("stream",(function(t){t.name="remote",t.user=e.roomInfo.user,e.streams.remoteUserMediaStream=t,e.reRenderStreams("remote"),e.mainStream="remote"}))}))})),this.peerConnection.on("call",(function(t){e.getUserMediaAccess((function(){e.loadingText=e.$t("CONNECTING"),t.answer(e.streams.localUserMediaStream),e.connection=t.peerConnection,e.loading=!1,t.on("stream",(function(t){t.name="remote",t.user=e.roomInfo.user,e.streams.remoteUserMediaStream=t,e.reRenderStreams("remote"),e.mainStream="remote"}))}))})),this.socket.on("callRejected",(function(){e.loadingText=e.$t("CALL_REJECTED"),e.destroyStreams(),location.href="/contacts"})),this.socket.on("prepareCall",(function(t){!0===t.status?e.loadingText=e.$t("CALLING"):"offline"===t.message?(e.loadingText=e.$t("USER_IS_OFFLINE"),e.destroyStreams(),location.href="/contacts"):"user is busy"===t.message&&(e.loadingText="the user is busy",e.destroyStreams(),location.href="/contacts")})),this.socket.on("endCall",(function(){e.loading=!0,e.loadingText=e.$t("CALL_ENDED"),e.destroyStreams(),location.href="/contacts"}))},methods:{toggleMicrophone:function(){this.microphoneLoader=!0,this.microphone?(this.streamsTracks.localTracks.userMediaTracks.microphone.enabled=!1,this.microphone=!1):(this.streamsTracks.localTracks.userMediaTracks.microphone.enabled=!0,this.microphone=!0),this.microphoneLoader=!1},toggleCamera:function(){if(this.cameraLoader=!0,this.camera)this.streamsTracks.localTracks.userMediaTracks.camera.enabled=!1,this.camera=!1;else if(this.streamsTracks.localTracks.userMediaTracks.camera.enabled=!0,this.camera=!0,null!==this.streamsTracks.localTracks.screenShareTracks.screenShareVideo){this.screenShare&&this.toggleScreenShare();var e,t=o(this.connection.getSenders());try{for(t.s();!(e=t.n()).done;){var r=e.value;"video"===r.track.kind&&r.replaceTrack(this.streamsTracks.localTracks.userMediaTracks.camera)}}catch(e){t.e(e)}finally{t.f()}}this.cameraLoader=!1},toggleScreenShare:function(){var e=this;if(this.screenShareLoader=!0,this.screenShare)"localScreenShare"===this.mainStream&&(this.mainStream="remote"),this.streamsTracks.localTracks.screenShareTracks.screenShareVideo.stop(),this.streamsTracks.localTracks.screenShareTracks.screenShareAudio&&this.streamsTracks.localTracks.screenShareTracks.screenShareAudio.stop(),this.streams.localScreenShareStream=null,this.screenShare=!1,this.screenShareLoader=!1;else{navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia,navigator.mediaDevices.getDisplayMedia({audio:{sampleRate:48e3},video:{aspectRatio:1.777777778,frameRate:10,cursor:"always"}}).then((function(t){t.getTracks().forEach((function(track){if("audio"===track.kind){track.name="screenShareAudio",e.streamsTracks.localTracks.screenShareTracks.screenShareAudio=track;var t=new MediaStream;t.addTrack(e.streamsTracks.localTracks.userMediaTracks.microphone);var r=new MediaStream;r.addTrack(track);var n=new AudioContext,c=n.createMediaStreamSource(t),l=n.createMediaStreamSource(r),d=n.createMediaStreamDestination();c.connect(d),l.connect(d);var m,h=d.stream,v=o(e.connection.getSenders());try{for(v.s();!(m=v.n()).done;){var f=m.value;"audio"===f.track.kind&&f.replaceTrack(h.getTracks()[0])}}catch(e){v.e(e)}finally{v.f()}}"video"===track.kind&&(track.name="screenShareVideo",track.addEventListener("ended",(function(){e.screenShare=!1,"localScreenShare"===e.mainStream&&(e.mainStream="remote"),e.streams.localScreenShareStream=null})),e.streamsTracks.localTracks.screenShareTracks.screenShareVideo=track)})),e.camera&&e.toggleCamera();var r,n=o(e.connection.getSenders());try{for(n.s();!(r=n.n()).done;){var c=r.value;"video"===c.track.kind&&c.replaceTrack(e.streamsTracks.localTracks.screenShareTracks.screenShareVideo)}}catch(e){n.e(e)}finally{n.f()}e.refreshLocalScreenShareStream(),e.screenShare=!0,e.screenShareLoader=!1})).catch((function(t){"localScreenShare"===e.mainStream&&(e.mainStream="remote"),e.streams.localScreenShareStream=null,e.screenShare=!1,e.screenShareLoader=!1,console.log(t)}))}},endCall:function(){this.socket.emit("endCall",this.peerUser),this.loading=!0,this.loadingText=this.$t("CALL_ENDED"),this.destroyStreams(),location.href="/contacts"},getStream:function(e){switch(e){case"local":return this.streams.localUserMediaStream;case"remote":return this.streams.remoteUserMediaStream;case"localScreenShare":return this.streams.localScreenShareStream}},reRenderStreams:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"local";switch(t){case"local":this.renderLocalStream=!1,this.$nextTick((function(){e.renderLocalStream=!0}));break;case"screenShare":this.renderScreenShareStream=!1,this.$nextTick((function(){e.renderScreenShareStream=!0}));break;case"remote":this.renderRemoteStream=!1,this.$nextTick((function(){e.renderRemoteStream=!0}));break;case"main":this.renderMainStream=!1,this.$nextTick((function(){e.renderMainStream=!0}))}},getUserMediaAccess:function(e){var t=this,r={echoCancellation:this.echoCancellation,noiseSuppression:this.noiseSuppression},o={};""!==this.selectedMicrophoneId&&(r.deviceId={exact:this.selectedMicrophoneId}),""!==this.selectedCameraId&&(o.deviceId={exact:this.selectedCameraId}),navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia,navigator.getUserMedia({audio:r,video:1===this.roomInfo.type&&o},(function(r){r.getTracks().forEach((function(track){"audio"===track.kind&&(""===t.selectedMicrophoneId&&t.$store.commit("call/saveSelectedMicrophoneId",track.getSettings().deviceId),track.name="microphone",t.streamsTracks.localTracks.userMediaTracks.microphone=track),"video"===track.kind&&(""===t.$store.state.selectedCameraId&&t.$store.commit("call/saveSelectedCameraId",track.getSettings().deviceId),track.name="camera",track.enabled=!1,t.streamsTracks.localTracks.userMediaTracks.camera=track)})),t.microphone=!0,t.camera=!1,t.refreshLocalUserMediaStream((function(){e&&"function"==typeof e&&e()})),t.userMediaAccess=1}),(function(e){t.userMediaAccess=-1,console.log(e)}))},refreshLocalUserMediaStream:function(e){var t=new MediaStream;null!=this.streamsTracks.localTracks.userMediaTracks.microphone&&t.addTrack(this.streamsTracks.localTracks.userMediaTracks.microphone),null!=this.streamsTracks.localTracks.userMediaTracks.camera&&t.addTrack(this.streamsTracks.localTracks.userMediaTracks.camera),t.user=this.$auth.user,t.name="local",this.streams.localUserMediaStream=t,this.reRenderStreams("local"),e&&"function"==typeof e&&e(),""===this.mainStream&&(this.mainStream="local")},refreshLocalScreenShareStream:function(){var e=new MediaStream;this.streamsTracks.localTracks.screenShareTracks.screenShareAudio&&e.addTrack(this.streamsTracks.localTracks.screenShareTracks.screenShareAudio),this.streamsTracks.localTracks.screenShareTracks.screenShareVideo&&e.addTrack(this.streamsTracks.localTracks.screenShareTracks.screenShareVideo),e.name="localScreenShare",e.user=this.$auth.user,this.streams.localScreenShareStream=e,this.reRenderStreams("screenShare")},selectAsMainStream:function(e){this.mainStream=e.name},destroyStreams:function(){this.streamsTracks.localTracks.userMediaTracks.camera&&this.streamsTracks.localTracks.userMediaTracks.camera.stop(),this.streamsTracks.localTracks.userMediaTracks.microphone&&this.streamsTracks.localTracks.userMediaTracks.microphone.stop(),this.streamsTracks.localTracks.screenShareTracks.screenShareVideo&&this.streamsTracks.localTracks.screenShareTracks.screenShareVideo.stop(),this.streamsTracks.localTracks.screenShareTracks.screenShareAudio&&this.streamsTracks.localTracks.screenShareTracks.screenShareAudio.stop()}},watch:{mainStream:function(){this.reRenderStreams("main")},remoteStream:function(e){e.user=this.roomInfo.user,e.name="remote",this.streams.remoteUserMediaStream=e,this.mainStream="remote"}}},l=c,d=(r(584),r(81)),m=r(74),h=r.n(m),v=r(531),f=r(547),S=r(255),k=r(256),x=r(162),T=r(253),_=r(548),y=r(45),component=Object(d.a)(l,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("v-overlay",{attrs:{value:e.loading,opacity:"1"}},[r("v-row",{staticClass:"d-flex justify-center",attrs:{"no-gutters":""}},[r("h1",[e._v(e._s(e.loadingText))])]),e._v(" "),r("label",{staticClass:"overline",staticStyle:{position:"fixed",bottom:"10px","text-align":"center",width:"100%"}},[e._v("EXOROYA")])],1),e._v(" "),1!==e.roomInfo.type||e.loading?e._e():r("v-sheet",{staticClass:"gridVideos mt-5"},[r("div",{staticClass:"toggles",style:("rtl"===e.directionOfLanguage?"left":"right")+":10px"},[r("v-btn",{attrs:{color:"red",icon:""},on:{click:e.endCall}},[r("v-icon",[e._v("mdi-phone-remove")])],1),e._v(" "),e.isMobile?e._e():r("v-btn",{attrs:{loading:e.screenShareLoader,outlined:e.screenShare,icon:""},on:{click:e.toggleScreenShare}},[e.screenShare?r("v-icon",[e._v("mdi-projector-screen-outline")]):r("v-icon",[e._v("mdi-projector-screen-off-outline")])],1),e._v(" "),r("v-btn",{attrs:{outlined:e.camera,loading:e.cameraLoader,icon:""},on:{click:e.toggleCamera}},[e.camera?r("v-icon",[e._v("mdi-camera-outline")]):r("v-icon",[e._v("mdi-camera-off-outline")])],1),e._v(" "),r("v-btn",{attrs:{outlined:e.microphone,loading:e.microphoneLoader,icon:""},on:{click:e.toggleMicrophone}},[e.microphone?r("v-icon",[e._v("mdi-microphone")]):r("v-icon",[e._v("mdi-microphone-off")])],1)],1),e._v(" "),r("v-row",[r("v-col",{staticClass:"mainStream pa-0",attrs:{cols:"12",sm:"12",md:"9",lg:"9",xl:"9"}},[e.renderMainStream?r("Stream",{attrs:{isMainStream:!0,srcObject:e.getStream(e.mainStream)}}):e._e()],1),e._v(" "),r("v-col",{staticClass:"listOfStreams px-0 mx-0 pa-0",attrs:{cols:"12",sm:"12",md:"3",lg:"3",xl:"3"}},[r("v-list",{staticClass:"mx-0",attrs:{width:"100%",height:"100%"}},[e.streams.localUserMediaStream&&e.renderLocalStream?r("v-list-item",{staticClass:"streamItem pt-1 pb-1"},[r("Stream",{attrs:{isMainStream:!1,srcObject:e.streams.localUserMediaStream},on:{selectAsMainStream:e.selectAsMainStream}})],1):e._e(),e._v(" "),e.streams.localScreenShareStream&&e.renderScreenShareStream?r("v-list-item",{staticClass:"streamItem pt-1 pb-1"},[r("Stream",{attrs:{isMainStream:!1,srcObject:e.streams.localScreenShareStream},on:{selectAsMainStream:e.selectAsMainStream}})],1):e._e(),e._v(" "),e.streams.remoteUserMediaStream&&e.renderRemoteStream?r("v-list-item",{staticClass:"streamItem pt-1 pb-1"},[r("Stream",{attrs:{isMainStream:!1,srcObject:e.streams.remoteUserMediaStream},on:{selectAsMainStream:e.selectAsMainStream}})],1):e._e()],1)],1)],1)],1),e._v(" "),0!==e.roomInfo.type||e.loading?e._e():r("v-sheet",{staticClass:"pa-5 rounded-lg",attrs:{"min-height":"80vh"}},[r("v-row",{staticClass:"d-flex justify-center mt-5 mb-0"},[r("ContactAvatar",{attrs:{avatar:e.roomInfo.user.avatar,name:e.roomInfo.user.firstName,color:e.roomInfo.user.color,size:180}})],1),e._v(" "),r("v-row",{staticClass:"d-flex justify-center mt-1"},[r("p",{staticClass:"mt-12 text-h5"},[e._v(e._s(e.roomInfo.user.firstName+" "+e.roomInfo.user.lastName))])]),e._v(" "),r("v-row",{staticClass:"d-flex justify-center mt-16"},[r("v-btn",{staticClass:"mx-5",attrs:{outlined:e.microphone,loading:e.microphoneLoader,"x-large":"",icon:""},on:{click:e.toggleMicrophone}},[e.microphone?r("v-icon",[e._v("mdi-microphone")]):r("v-icon",[e._v("mdi-microphone-off")])],1),e._v(" "),r("v-btn",{attrs:{color:"red","x-large":"",icon:""},on:{click:e.endCall}},[r("v-icon",[e._v("mdi-phone-remove")])],1)],1),e._v(" "),e.streams.remoteUserMediaStream&&e.renderRemoteStream?r("Stream",{attrs:{isMainStream:!1,voiceCall:!0,srcObject:e.streams.remoteUserMediaStream},on:{selectAsMainStream:e.selectAsMainStream}}):e._e()],1)],1)}),[],!1,null,"1374a326",null);t.default=component.exports;h()(component,{Stream:r(579).default,ContactAvatar:r(354).default}),h()(component,{VBtn:v.a,VCol:f.a,VIcon:S.a,VList:k.a,VListItem:x.a,VOverlay:T.a,VRow:_.a,VSheet:y.a})}}]);